---
title: "Var estimation with using Garch family"
author: "ElgunIsmayilov"
date: "`r Sys.Date()`"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
# Importing necessary libraries
```{r libraries}
library(tidyverse)
library(zoo)
library(xts)
library(quantmod)
library(imputeTS)
library(tseries)

```

# Import the data

```{r data}
# Define the tickers
Dow_Jones <- getSymbols("^DJI",src = "yahoo",from = "2019-01-01", to = "2023-01-01",auto.assign = FALSE)
Tmsc <- getSymbols("TSM",src = "yahoo",from = "2019-01-01", to = "2023-01-01",auto.assign = FALSE)
Pound <- getSymbols("GBPUSD=X",src = "yahoo",from = "2019-01-01", to = "2023-01-01",auto.assign = FALSE)
Silver <- getSymbols("SI=F",src = "yahoo",from = "2019-01-01", to = "2023-01-01",auto.assign = FALSE)
BNB<- getSymbols("BNB-USD",src = "yahoo",from = "2019-01-01", to = "2023-01-01",auto.assign = FALSE)
# Extract the adjusted closing prices for each symbol
dji_adjclose <- Ad(Dow_Jones)
tsm_adjclose <- Ad(Tmsc)
gbpusd_adjclose <- Ad(Pound)
si_adjclose <- Ad(Silver)
bnbusd_adjclose <- Ad(BNB)

# Merge the data into a single xts object
portfolio_xts <- merge(dji_adjclose, tsm_adjclose, gbpusd_adjclose, si_adjclose, bnbusd_adjclose)
portfolio_xts <- na.locf(portfolio_xts)



```



```{r}
# Merge the data into a single xts object
portfolio_xts <- merge(dji_adjclose, tsm_adjclose, gbpusd_adjclose, si_adjclose, bnbusd_adjclose)
portfolio_xts <- na_locf(portfolio_xts)
# Convert to data frame
portfolio_frame <- data.frame(Date=index(portfolio_xts),coredata(portfolio_xts))
colnames(portfolio_frame) <- c("Date","DJI", "TSM", "GBPUSD", "Silver", "BNB")

print(portfolio_frame)
```

```{r}
# Calculate daily returns
daily_returns_xts <- Return.calculate(portfolio_xts, method = "discrete")
# Remove the first row which contains NA values
daily_returns_xts <- daily_returns_xts[-1, ]
# View the result
print(daily_returns_xts)


```



```{r}
# Number of assets
num_assets <- ncol(daily_returns_xts)

# Equal weights for each asset
weights <- rep(1/num_assets, num_assets)

# Calculate portfolio returns
portfolio_returns_xts <- xts(rowSums(daily_returns_xts * weights), order.by = index(daily_returns_xts))




```

```{r}


# Convert xts object to data frame with Date column
portfolio_returns_df <- data.frame(Date = index(portfolio_returns_xts),
                                   Portfolio_Return = coredata(portfolio_returns_xts))

# View the data frame to ensure it is correct
print(portfolio_returns_df)








```


```{r}


# Assuming 'portfolio_returns_df' is your data frame containing Date and Daily_Return columns
# Create a scatter plot
ggplot(portfolio_returns_df, aes(x = Date, y = portfolio_returns_df$Portfolio_Return)) +
  geom_point() +
  labs(title = "Portfolio Daily Returns",
       x = "Date",
       y = "Daily Return")



```

```{r}
# Distribution plot
distribution_plot <- ggplot(portfolio_returns_df, aes(x = Portfolio_Return)) +
  geom_histogram(binwidth = 0.01, fill = "skyblue", color = "black") +
  labs(title = "Distribution of Portfolio Returns",
       x = "Portfolio Return",
       y = "Frequency")

# Show the distribution plot
print(distribution_plot)


```

```{r}

adf.test(portfolio_returns_df$Portfolio_Return)
```

```{r}

```